<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>RASPI KUBERNETES CLUSTER WITH RANCHER | Olivia Snowden&#39;s Blog</title>
<meta name="keywords" content="code, raspberrypi, home-lab, docker">
<meta name="description" content="Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.
K3S is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle.  In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:">
<meta name="author" content="Olivia Snowden">
<link rel="canonical" href="http://localhost:1313/raspberry-pi-kubernetes/">
<link crossorigin="anonymous" href="http://localhost:1313/assets/css/stylesheet.7f8702ad4c3159231ff7aa5f7bf1a574a69e60a988350dee1489d2c17b25d91e.css" integrity="sha256-f4cCrUwxWSMf96pfe/GldKaeYKmINQ3uFInSwXsl2R4=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/raspberry-pi-kubernetes/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/raspberry-pi-kubernetes/">
  <meta property="og:site_name" content="Olivia Snowden&#39;s Blog">
  <meta property="og:title" content="RASPI KUBERNETES CLUSTER WITH RANCHER">
  <meta property="og:description" content="Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.
K3S is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle. In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2020-07-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-07-17T00:00:00+00:00">
    <meta property="article:tag" content="Code">
    <meta property="article:tag" content="Raspberrypi">
    <meta property="article:tag" content="Home-Lab">
    <meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RASPI KUBERNETES CLUSTER WITH RANCHER">
<meta name="twitter:description" content="Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.
K3S is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle.  In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "RASPI KUBERNETES CLUSTER WITH RANCHER",
      "item": "http://localhost:1313/raspberry-pi-kubernetes/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "RASPI KUBERNETES CLUSTER WITH RANCHER",
  "name": "RASPI KUBERNETES CLUSTER WITH RANCHER",
  "description": "Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.\nK3S is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle. In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:\n",
  "keywords": [
    "code", "raspberrypi", "home-lab", "docker"
  ],
  "articleBody": "Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.\nK3S is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle. In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:\n3 Raspberry Pi 4s GeekPi Raspberry Pi Cluster Case w/Heat Sinks and Fans 3 power cables and a power supply 3 patch cables and a switch connected to a DNS \u0026 router 3 miniSD cards and a CanaKit MicroSD USB Reader A Kubernetes cluster runs by placing containers into groups called pods that run on nodes. A node can be a virtual or physical machine. Each cluster has a master node and at least one worker node that it reports to it. I had 3 Pis to use, so in my cluster I built one master node and two worker nodes. kubectl is the Kubernetes command-line tool that you can use to run commands against a cluster. When building this cluster I used a few kubectl commands to check my progress, but they can be used for a lot more.\nSTEP 1: Build case (optional) I got a case, which is basically a rack, to safely store the 3 Pis for the cluster. The first step was building the case, which consisted of screwing each Raspberry Pi to a base and stacking them one on top of the other. In between each Pi was a fan connected to the Pi below it to provide air flow, and I made sure to place heat sinks on the CPU, RAM and LAN of each Pi. The cooling equipment is probably unnecessary for this small project, but it will be good to have for a more CPU intense project in the future.\nSTEP 2: Set up the Raspberry Pis Next, each Pi will need an SD card with an OS on it. They‚Äôll also need to be connected to the internet with a static IP and have SSH abilities. You can go about this any way you want, but I chose to install Raspberry Pi OS 64 bit, a beta version of the new Pi OS, and configure the Pis to be headless.\nI used a laptop running Linux Mint to put the OSs onto the SD cards. This involved downloading the OS and the app image of balenaEtcher onto the laptop and then putting the little SD cards in a USB with a MicroSD card adapter. Once plugged into the laptop, I used balenaEtcher to flash Raspberry Pi OS (64 bit) onto each card.\nOnce done I configured the SD cards so that the Pis would be headless (automatically boot with SSH ability and an IP).\nAfter the SD cards are in the Pis, plug each Pi into a power supply and connected each one to the switch using patch cables.\nSince I configured the Pis to be headless, I checked the leased IPs on the router in the lab to find the IPs of each Pi and set that IP to be static.\nSTEP 3: Change hostnames (optional) Building a Kubernetes cluster on Raspberry Pis involves a lot of SSH-ing, so to make it easier you can rename each Pi. I used the same names I gave each Pi on the router (kmaster, knode1, and knode2). On my PC (a MacBook) I ran sudo nano /etc/host to enter the hosts file. In the file I added three new lines, each containing the IP of a node and its friendly name.\nI then SSH-ed into each Pi one by one and changed its name in the hostname file by running sudo nano /etc/hostname.\nI then entered the /etc/host file like before to remove any instance of the old hostname and replace it with the new one.\nOnce those files are edited, reboot the Pis.\nSTEP 4: Create the master node SSH into the Pi you designated to be the master node.\nFirst, enter the /boot/cmdline.txt file to edit it (sudo nano /boot/cmdline.txt). At the end of the line in the file, add cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory . Save the file and reboot.\nTo install K3S on the master node, run the following command which uses curl to download K3S from its website:\ncurl -sfL http://get.k3s.io | sh - To make sure the K3S installed correctly, and to check its status, use:\nsudo systemctl status k3s\nYou should see that you have the k3s service running on your Pi. To check your nodes, run:\nsudo k3s kubectl get nodes At this point, you should only see your master node up and running.\nTo add agent, or worker, nodes to your master node you need the token the master node generates. To get it:\nsudo cat /var/lib/rancher/k3s/server/node-token\nCopy the token and save it for later.\nSTEP 5: Create agent nodes To create a worker node, SSH into the Raspberry Pi and run:\ncurl -sfL http://get.k3s.io | K3S_URL=https://_your_master_node_IP_:643 K3S_TOKEN=_token_ sh - There are a few variations of commands to set up a worker node using K3S, the one listed above instals K3S and then passes along the IP/Port of the master node and its token so that the workers know who to report to.\nRepeat the above command for each Pi designated to be a worker node.\nSTEP 6: Install K3S on PC It can be inconvenient to SSH into the Kubernetes master node to work on your cluster. You can install K3S onto your PC by first logging on to the master node and copying the configuration file found by running sudo cat /etc/rancher/k3s/k3s.yaml .\nOn your PC, make a directory for the config file ( mkdir ~/.kube) and paste the file into it. Before saving, change the ‚Äúhttps://localhost:6443‚Äù line in the file to ‚Äúhttps://kmaster:6443‚Äù.\nThen install kubectl on your PC, simple instructions for your PC‚Äôs OS can be found here.\nFinally, run kubectl get nodes on your PC to see the kubernetes cluster you have created.\n",
  "wordCount" : "1063",
  "inLanguage": "en",
  "datePublished": "2020-07-17T00:00:00Z",
  "dateModified": "2020-07-17T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Olivia Snowden"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/raspberry-pi-kubernetes/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Olivia Snowden's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Olivia Snowden&#39;s Blog (Alt + H)">Olivia Snowden&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                    <ul class="lang-switch"><li>|</li>
                        <li>
                            <a href="http://localhost:1313/fr/" title="French"
                                aria-label=":fr:">üá´üá∑</a>
                        </li>
                        <li>
                            <a href="http://localhost:1313/fa/" title="Fa"
                                aria-label="Fa">Fa</a>
                        </li>
                    </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/adityatelange/hugo-PaperMod/wiki/" title="WiKi">
                    <span>WiKi</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      RASPI KUBERNETES CLUSTER WITH RANCHER
    </h1>
    <div class="post-meta"><span title='2020-07-17 00:00:00 +0000 UTC'>Fri, Jul 17, 2020</span>&nbsp;¬∑&nbsp;<span>5 min</span>&nbsp;¬∑&nbsp;<span>Olivia Snowden</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#step-1-build-case-optional" aria-label="STEP 1: Build case (optional)">STEP 1: Build case (optional)</a></li>
                <li>
                    <a href="#step-2-set-up-the-raspberry-pis" aria-label="STEP 2: Set up the Raspberry Pis">STEP 2: Set up the Raspberry Pis</a></li>
                <li>
                    <a href="#step-3-change-hostnames-optional" aria-label="STEP 3: Change hostnames (optional)">STEP 3: Change hostnames (optional)</a></li>
                <li>
                    <a href="#step-4-create-the-master-node" aria-label="STEP 4: Create the master node">STEP 4: Create the master node</a></li>
                <li>
                    <a href="#step-5-create-agent-nodes" aria-label="STEP 5: Create agent nodes">STEP 5: Create agent nodes</a></li>
                <li>
                    <a href="#step-6-install-k3s-on-pc" aria-label="STEP 6: Install K3S on PC">STEP 6: Install K3S on PC</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Kubernetes provides a framework to orchestrate multiple containers, verses working with one container at a time. To practice managing containers I opted to build a Kubernetes cluster on Raspberry Pis using Rancher. Rancher came about soon after Docker introduced containers to the market, and provides an open-source platform for enterprises to easily use Kubernetes in their environment.</p>
<p><a href="https://k3s.io/">K3S</a> is a Rancher product that allows you to deploy a Kubernetes cluster using a single binary file thats less than 40MB. K3S is ideal for Raspberry Pis, since traditionally building a Kubernetes cluster on Pis could be too much for them to handle.  In addition to K3S this is what I used to build a simple Kubernetes cluster in my home lab:</p>
<ul>
<li>3 Raspberry Pi 4s</li>
<li><a href="https://www.amazon.com/GeeekPi-Raspberry-Cluster-Cooling-Heatsink/dp/B07MW3GM1T/ref=asc_df_B07MW3GM1T/?tag=hyprod-20&amp;linkCode=df0&amp;hvadid=416652333997&amp;hvpos=&amp;hvnetw=g&amp;hvrand=18339680216412398047&amp;hvpone=&amp;hvptwo=&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9058015&amp;hvtargid=pla-831212700454&amp;psc=1&amp;tag=&amp;ref=&amp;adgrpid=100759324064&amp;hvpone=&amp;hvptwo=&amp;hvadid=416652333997&amp;hvpos=&amp;hvnetw=g&amp;hvrand=18339680216412398047&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9058015&amp;hvtargid=pla-831212700454">GeekPi Raspberry Pi Cluster Case w/Heat Sinks and Fans </a></li>
<li>3 power cables and a power supply</li>
<li>3 patch cables and a switch connected to a DNS &amp; router</li>
<li>3 miniSD cards and a <a href="https://www.canakit.com/mini-micro-sd-usb-reader.html">CanaKit MicroSD USB Reader </a></li>
</ul>
<p>A Kubernetes cluster runs by placing containers into groups called <em>pods</em> that run on nodes. A node can be a virtual or physical machine. Each cluster has a master node and at least one worker node that it reports to it. I had 3 Pis to use, so in my cluster I built one master node and two worker nodes. kubectl is the Kubernetes command-line tool that you can use to run commands against a cluster. When building this cluster I used a few kubectl commands to check my progress, but they can be used for a lot more.</p>
<h4 id="step-1-build-case-optional">STEP 1: Build case (optional)<a hidden class="anchor" aria-hidden="true" href="#step-1-build-case-optional">#</a></h4>
<p>I got a case, which is basically a rack, to safely store the 3 Pis for the cluster. The first step was building the case, which consisted of screwing each Raspberry Pi to a base and stacking them one on top of the other. In between each Pi was a fan connected to the Pi below it to provide air flow, and I made sure to place heat sinks on the CPU, RAM and LAN of each Pi. The cooling equipment is probably unnecessary for this small project, but it will be good to have for a more CPU intense project in the future.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-1.jpeg"></p>
<h4 id="step-2-set-up-the-raspberry-pis">STEP 2: Set up the Raspberry Pis<a hidden class="anchor" aria-hidden="true" href="#step-2-set-up-the-raspberry-pis">#</a></h4>
<p>Next, each Pi will need an SD card with an OS on it. They&rsquo;ll also need to be connected to the internet with a static IP and have SSH abilities. You can go about this any way you want, but I chose to install Raspberry Pi OS 64 bit, a beta version of the new Pi OS, and configure the Pis to be headless.</p>
<p>I used a laptop running Linux Mint to put the OSs onto the SD cards. This involved downloading the OS and the app image of balenaEtcher onto the laptop and then putting the little SD cards in a USB with a MicroSD card adapter. Once plugged into the laptop, I used balenaEtcher to flash Raspberry Pi OS (64 bit) onto each card.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-2.png"></p>
<p>Once done I configured the SD cards so that the Pis would be headless (automatically boot with SSH ability and an IP).</p>
<p>After the SD cards are in the Pis, plug each Pi into a power supply and connected each one to the switch using patch cables.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-3.jpeg"></p>
<p>Since I configured the Pis to be headless, I checked the leased IPs on the router in the lab to find the IPs of each Pi and set that IP to be static.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-4.png"></p>
<h4 id="step-3-change-hostnames-optional">STEP 3: Change hostnames (optional)<a hidden class="anchor" aria-hidden="true" href="#step-3-change-hostnames-optional">#</a></h4>
<p>Building a Kubernetes cluster on Raspberry Pis involves a lot of SSH-ing, so to make it easier you can rename each Pi. I used the same names I gave each Pi on the router (kmaster, knode1, and knode2). On my PC (a MacBook) I ran <code>sudo nano /etc/host</code> to enter the hosts file. In the file I added three new lines, each containing the IP of a node and its friendly name.</p>
<p>I then SSH-ed into each Pi one by one and changed its name in the hostname file by running <code>sudo nano /etc/hostname</code>.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-5.png"></p>
<p>I then entered the /etc/host file like before to remove any instance of the old hostname and replace it with the new one.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-6.png"></p>
<p>Once those files are edited, reboot the Pis.</p>
<h4 id="step-4-create-the-master-node">STEP 4: Create the master node<a hidden class="anchor" aria-hidden="true" href="#step-4-create-the-master-node">#</a></h4>
<p>SSH into the Pi you designated to be the master node.</p>
<p>First, enter the /boot/cmdline.txt file to edit it (<code>sudo nano /boot/cmdline.txt</code>). At the end of the line in the file, add <code>cgroup_enable=cpuset cgroup_memory=1 cgroup_enable=memory</code> . Save the file and reboot.</p>
<p>To install K3S on the master node, run the following command which uses curl to download K3S from its website:</p>
<pre><code>&lt;code&gt;curl -sfL &lt;a href=&quot;http://get.k3s.io/&quot;&gt;http://get.k3s.io&lt;/a&gt; | sh -&lt;/code&gt;
</code></pre>
<p>To make sure the K3S installed correctly, and to check its status, use:</p>
<p><code>sudo systemctl status k3s</code></p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-7.png"></p>
<p>You should see that you have the k3s service running on your Pi. To check your nodes, run:</p>
<p><code>sudo k3s kubectl get nodes </code></p>
<p>At this point, you should only see your master node up and running.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-8.png"></p>
<p>To add agent, or worker, nodes to your master node you need the token the master node generates. To get it:</p>
<p><code>sudo cat /var/lib/rancher/k3s/server/node-token</code></p>
<p>Copy the token and save it for later.</p>
<h4 id="step-5-create-agent-nodes">STEP 5: Create agent nodes<a hidden class="anchor" aria-hidden="true" href="#step-5-create-agent-nodes">#</a></h4>
<p>To create a worker node, SSH into the Raspberry Pi and run:</p>
<p><code>curl -sfL http://get.k3s.io | K3S_URL=https://_your_master_node_IP_:643 K3S_TOKEN=_token_ sh - </code></p>
<p>There are a few variations of commands to set up a worker node using K3S, the one listed above instals K3S and then passes along the IP/Port of the master node and its token so that the workers know who to report to.</p>
<p>Repeat the above command for each Pi designated to be a worker node.</p>
<h4 id="step-6-install-k3s-on-pc">STEP 6: Install K3S on PC<a hidden class="anchor" aria-hidden="true" href="#step-6-install-k3s-on-pc">#</a></h4>
<p>It can be inconvenient to SSH into the Kubernetes master node to work on your cluster. You can install K3S onto your PC by first logging on to the master node and copying the configuration file found by running <code>sudo cat /etc/rancher/k3s/k3s.yaml</code> .</p>
<p>On your PC, make a directory for the config file ( <code>mkdir ~/.kube</code>) and paste the file into it. Before saving, change the &ldquo;https://localhost:6443&rdquo; line in the file to &ldquo;https://kmaster:6443&rdquo;.</p>
<p>Then install kubectl on your PC, simple instructions for your PC&rsquo;s OS can be found <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">here</a>.</p>
<p>Finally, run <code>kubectl get nodes</code> on your PC to see the kubernetes cluster you have created.</p>
<p><img loading="lazy" src="http://localhost:1313/raspberry-9.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/code/">Code</a></li>
      <li><a href="http://localhost:1313/tags/raspberrypi/">Raspberrypi</a></li>
      <li><a href="http://localhost:1313/tags/home-lab/">Home-Lab</a></li>
      <li><a href="http://localhost:1313/tags/docker/">Docker</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/bash-basics/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>BASH BASICS</span>
  </a>
  <a class="next" href="http://localhost:1313/terraform-in-vsphere/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>TERRAFORM IN vSPHERE</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on x"
            href="https://x.com/intent/tweet/?text=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER&amp;url=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f&amp;hashtags=code%2craspberrypi%2chome-lab%2cdocker">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f&amp;title=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER&amp;summary=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER&amp;source=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f&title=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on whatsapp"
            href="https://api.whatsapp.com/send?text=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER%20-%20http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on telegram"
            href="https://telegram.me/share/url?text=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER&amp;url=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share RASPI KUBERNETES CLUSTER WITH RANCHER on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=RASPI%20KUBERNETES%20CLUSTER%20WITH%20RANCHER&u=http%3a%2f%2flocalhost%3a1313%2fraspberry-pi-kubernetes%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>¬© <a href="https://github.com/adityatelange/hugo-PaperMod/graphs/contributors">PaperMod Contributors</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
